import { IVulnerability } from "src/interfaces/vulnerability.interface"
import { vulnerabilityModel } from "../models/vulnerability.model"

class VulnerabilityService {
  async getVulns(userId: string, scanId: string) {
    return await vulnerabilityModel
      .find({ userId: userId, scanId: scanId })
      .sort({ createdAt: -1 })
  }

  async getVulnById(userId: string, vulnId: string) {
    return await vulnerabilityModel.findOne({ userId: userId, _id: vulnId })
  }

  async createVuln(vulnData: IVulnerability) {
    const scan = new vulnerabilityModel(vulnData)
    return await scan.save()
  }
}

export const vulnerabilityService = new VulnerabilityService()
